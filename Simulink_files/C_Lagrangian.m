function [C] = C_Lagrangian(q, qD)


a1 = 0.15;
a2 = 0.4;
a3 = 0.3;
a4 = 0.16;

t1 = q(1);
d1 = q(2);
t2 = q(3);

dt1 = qD(1);
dd1 = qD(2);
dt2 = qD(3);





% C = [[(6*a2*a4*sin(t2))/5 - (3*a4*dt2*(a4*sin(2*t2) + 2*a2*sin(t2)))/10 + (6*a4^2*cos(t2)*sin(t2))/5,                                    0,                                          (9*2^(1/2)*sin(t1 + pi/4))/16000 - (9*2^(1/2)*dt1*sin(t1 + pi/4))/4000]
% [                                                                                             0,                                    0,                                                                           (a4*dt2*sin(t2))/10 - (a4*sin(t2))/10]
% [                         (9*2^(1/2)*sin(t1 + pi/4))/2000 - (9*2^(1/2)*dt1*sin(t1 + pi/4))/4000, (a4*dt2*sin(t2))/10 - (a4*sin(t2))/5, (41*sin(2*t1))/16000 - (9*cos(t1)^2)/4000 - (dt1*((41*sin(2*t1))/2000 - (9*cos(t1)^2)/500 + 9/1000))/2 + 9/8000]];
 

C = [ 
[-(3*a4*dt2*(a4*sin(2*t2) + 2*a2*sin(t2))*(2*dt1 - dt2))/10,                                 0,           -(9*2^(1/2)*dt2*sin(t1 + pi/4)*(2*dt1 - dt2))/4000]
[                                                         0,                                 0,                                        (a4*dt2^2*sin(t2))/10]
[        -(9*2^(1/2)*sin(t1 + pi/4)*(2*dt1^2 - dt2^2))/4000, (a4*dt2*sin(t2)*(2*dd1 - dt2))/10, -(dt2*(2*dt1 - dt2)*(41*sin(2*t1) - 36*cos(t1)^2 + 18))/4000]];
 
end

